<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Website Prompt Generator (Pro - Optimized)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/heroicons@2.1.3/24/outline/index.js"></script>
    <script src="https://unpkg.com/heroicons@2.1.3/24/solid/index.js"></script>
    <style>
        :root {
            --brand: #4f46e5;
            --brand-light: #eef2ff;
            --brand-dark: #4338ca;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-200: #e2e8f0;
            --gray-300: #cbd5e1;
            --gray-400: #94a3b8;
            --gray-500: #64748b;
            --gray-600: #475569;
            --gray-700: #334155;
            --gray-800: #1e293b;
            --gray-900: #0f172a;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            --radius-sm: 0.25rem;
            --radius: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--gray-50);
            color: var(--gray-800);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .app-layout {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background-color: var(--gray-900);
            border-right: 1px solid var(--gray-800);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            flex-shrink: 0;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem;
            margin-bottom: 1rem;
        }

        .sidebar-logo-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: var(--radius);
            background: var(--brand);
            color: white;
            display: grid;
            place-items: center;
            font-weight: 700;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .sidebar-logo-text h1 {
            font-weight: 600;
            color: var(--gray-100);
            font-size: 1rem;
        }

        .sidebar-logo-text p {
            font-size: 0.75rem;
            color: var(--gray-400);
        }

        .sidebar-nav {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .sidebar-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            text-align: left;
            font-weight: 500;
            font-size: 0.9rem;
            color: var(--gray-400);
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .sidebar-btn:hover {
            background: var(--gray-800);
            color: var(--gray-200);
        }

        .sidebar-btn.active {
            background: var(--brand);
            color: white;
            font-weight: 600;
        }

        .sidebar-btn svg {
            width: 1.25rem;
            height: 1.25rem;
            flex-shrink: 0;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Header */
        .header {
            position: sticky;
            top: 0;
            z-index: 40;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 1.5rem;
        }

        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 100%;
        }

        .header-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            font-size: 0.875rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .btn-sm {
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--brand), var(--brand-dark));
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background-color: white;
            border: 1px solid var(--gray-300);
            color: var(--gray-700);
        }

        .btn-secondary:hover {
            background-color: var(--gray-50);
            border-color: var(--gray-400);
        }

        .btn-tertiary {
            background-color: transparent;
            color: var(--gray-500);
        }

        .btn-tertiary:hover {
            color: var(--gray-800);
            background-color: var(--gray-100);
        }

        .btn-icon {
            padding: 0.5rem;
        }

        /* Content Area */
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (min-width: 1024px) {
            .content-grid {
                grid-template-columns: 3fr 1fr;
            }
        }

        /* Panel */
        .panel {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .panel.active {
            display: block;
        }

        .panel-card {
            background-color: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .panel-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-100);
        }

        .panel-header h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 0.25rem;
        }

        .panel-header p {
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        .panel-body {
            padding: 1.5rem;
        }

        .panel-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.25rem;
        }

        @media (min-width: 768px) {
            .panel-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--gray-700);
            margin-bottom: 0.5rem;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--gray-300);
            border-radius: var(--radius);
            font-size: 0.875rem;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--brand);
            box-shadow: 0 0 0 3px var(--brand-light);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Tabs */
        .tab-nav {
            display: flex;
            overflow-x: auto;
            border-bottom: 1px solid var(--gray-200);
            padding: 0 1.5rem;
            margin-top: -1px;
            scrollbar-width: none;
        }

        .tab-nav::-webkit-scrollbar {
            display: none;
        }

        .tab-btn {
            padding: 1rem 1.25rem;
            border-bottom: 2px solid transparent;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--gray-500);
            background: transparent;
            border: none;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .tab-btn:hover {
            color: var(--gray-700);
        }

        .tab-btn.active {
            color: var(--brand);
            border-color: var(--brand);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Tags */
        .tag-container {
            margin-top: 0.5rem;
        }

        .tag-wrap {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .tag-chip {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.35rem 0.75rem;
            border-radius: 9999px;
            background-color: var(--gray-100);
            border: 1px solid var(--gray-200);
            font-size: 0.75rem;
            font-weight: 500;
        }

        .tag-chip button {
            background: none;
            border: none;
            color: var(--gray-500);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            transition: all 0.15s ease;
        }

        .tag-chip button:hover {
            background-color: var(--gray-200);
            color: var(--danger);
        }

        /* Toggle Section */
        .page-toggle-label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: var(--radius);
            background-color: var(--gray-50);
            border: 1px solid var(--gray-200);
            font-weight: 500;
            color: var(--gray-700);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .page-toggle-label:hover {
            background-color: var(--gray-100);
        }

        .page-section {
            display: none;
            background-color: var(--gray-50);
            border-radius: var(--radius-lg);
            padding: 1.25rem;
            margin-top: 1rem;
            flex-direction: column;
            gap: 1rem;
        }

        .page-section.active {
            display: flex;
        }

        /* Template Cards */
        .template-card {
            position: relative;
            background: var(--gray-50);
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            animation: slideIn 0.3s ease;
        }

        .template-remove-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            color: var(--gray-400);
            background: transparent;
            border: none;
            border-radius: 50%;
            width: 1.75rem;
            height: 1.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .template-remove-btn:hover {
            color: var(--danger);
            background-color: #fee2e2;
        }

        .template-card-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 640px) {
            .template-card-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* Code Output */
        .code-output {
            position: relative;
        }

        .code-textarea {
            background-color: var(--gray-900);
            color: #a5f3fc;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            font-size: 0.875rem;
            border: 1px solid var(--gray-800);
            padding: 1rem;
            border-radius: var(--radius);
            resize: vertical;
            min-height: 300px;
            width: 100%;
        }

        .code-textarea:focus {
            outline: none;
            border-color: var(--brand);
            box-shadow: 0 0 0 3px var(--brand-light);
        }

        .copy-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
        }

        /* Aside */
        .aside-card {
            background-color: white;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            padding: 1.25rem;
        }

        .aside-card h3 {
            font-weight: 600;
            color: var(--gray-800);
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .info-box {
            font-size: 0.75rem;
            color: var(--gray-500);
            background-color: var(--gray-50);
            padding: 0.75rem;
            border-radius: var(--radius);
            border: 1px solid var(--gray-200);
            margin-top: 1rem;
        }

        /* Toast */
        .toast {
            position: fixed;
            right: 1.5rem;
            bottom: 1.5rem;
            z-index: 50;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .toast-item {
            padding: 0.75rem 1.25rem;
            background-color: var(--gray-800);
            color: var(--gray-100);
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            font-weight: 500;
            font-size: 0.875rem;
            border: 1px solid var(--gray-700);
            animation: slideInRight 0.3s ease;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(10px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Mobile Responsive */
        .mobile-menu-btn {
            display: none;
            background: transparent;
            border: none;
            color: var(--gray-700);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: var(--radius);
        }

        .mobile-menu-btn:hover {
            background-color: var(--gray-100);
        }

        @media (max-width: 1023px) {
            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                z-index: 50;
                transform: translateX(-100%);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .mobile-menu-btn {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .overlay {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 40;
                display: none;
            }

            .overlay.open {
                display: block;
            }
        }

        /* Progress Indicator */
        .progress-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .progress-step {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--gray-500);
        }

        .progress-step.active {
            color: var(--brand);
            font-weight: 500;
        }

        .progress-step.completed {
            color: var(--success);
        }

        .progress-step-number {
            width: 1.75rem;
            height: 1.75rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 600;
            background-color: var(--gray-200);
            color: var(--gray-600);
        }

        .progress-step.active .progress-step-number {
            background-color: var(--brand);
            color: white;
        }

        .progress-step.completed .progress-step-number {
            background-color: var(--success);
            color: white;
        }

        .progress-connector {
            flex: 1;
            height: 2px;
            background-color: var(--gray-200);
            margin: 0 0.5rem;
        }

        .progress-step.completed + .progress-connector {
            background-color: var(--success);
        }

        /* Character Counter */
        .char-counter {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 0.5rem;
            font-size: 0.75rem;
            color: var(--gray-500);
        }
    </style>
</head>
<body class="app-layout">
    <!-- Mobile Overlay -->
    <div id="overlay" class="overlay"></div>

    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar">
        <div class="sidebar-logo">
            <div class="sidebar-logo-icon">AI</div>
            <div class="sidebar-logo-text">
                <h1>AI Prompt Generator</h1>
                <p>Pro Edition</p>
            </div>
        </div>

        <div class="sidebar-nav">
            <button data-panel-id="panel-1" class="sidebar-btn active">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.21 1.39l-1.07 1.071c-.07.07-.127.153-.169.242l-.22 1.359c-.09.542-.56.94-1.11.94h-2.593c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.063-.374-.313-.686-.645-.87-.074-.04-.147-.083-.22-.127a1.125 1.125 0 0 1-1.075-.124l-1.217.456a1.125 1.125 0 0 1-1.37-.49l-1.296-2.247a1.125 1.125 0 0 1 .21-1.39l1.07-1.071c.07-.07.127-.153.169-.242l.22-1.359Z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                Global Settings
            </button>
            <button data-panel-id="panel-2" class="sidebar-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                </svg>
                Landing Page
            </button>
            <button data-panel-id="panel-3" class="sidebar-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                </svg>
                Pages
            </button>
            <button data-panel-id="panel-4" class="sidebar-btn">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75 22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3-4.5 16.5" />
                </svg>
                Output
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <header class="header">
            <div class="header-inner">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button id="mobileMenuBtn" class="mobile-menu-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="24" height="24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                        </svg>
                    </button>
                    <h1 id="header-title" class="header-title">Global Settings</h1>
                </div>
                
                <div class="header-actions">
                    <button id="btnReset" class="btn btn-tertiary">Reset</button>
                    <button id="btnExportJson" class="btn btn-secondary">Export JSON</button>
                    <button id="btnDownloadMd" class="btn btn-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="16" height="16">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                        </svg>
                        Download .md
                    </button>
                </div>
            </div>
        </header>

        <div class="content">
            <div class="content-grid">
                <div class="main-panels">
                    <!-- Progress Indicator -->
                    <div class="progress-indicator">
                        <div class="progress-step active" data-panel="panel-1">
                            <div class="progress-step-number">1</div>
                            <span>Global</span>
                        </div>
                        <div class="progress-connector"></div>
                        <div class="progress-step" data-panel="panel-2">
                            <div class="progress-step-number">2</div>
                            <span>Landing</span>
                        </div>
                        <div class="progress-connector"></div>
                        <div class="progress-step" data-panel="panel-3">
                            <div class="progress-step-number">3</div>
                            <span>Pages</span>
                        </div>
                        <div class="progress-connector"></div>
                        <div class="progress-step" data-panel="panel-4">
                            <div class="progress-step-number">4</div>
                            <span>Output</span>
                        </div>
                    </div>

                    <!-- Panel 1: Global Settings -->
                    <div id="panel-1" class="panel active">
                        <div class="panel-card">
                            <div class="panel-header">
                                <h2>🌐 Global Settings</h2>
                                <p>Configure project name, audience, design style, colors, and technology stack.</p>
                            </div>
                            <div class="panel-body">
                                <div class="panel-grid">
                                    <div class="form-group">
                                        <label class="form-label" for="projectName">Project Name</label>
                                        <input id="projectName" class="form-input" placeholder="e.g., Key Propolis">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="audience">Target Audience</label>
                                        <input id="audience" class="form-input" placeholder="UMKM, affiliates, parents...">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="style">Design Style</label>
                                        <select id="style" class="form-select">
                                            <option>Modern minimalis</option>
                                            <option>Elegan premium</option>
                                            <option>Playful berwarna</option>
                                            <option>Corporate clean</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="color">Primary Color</label>
                                        <input id="color" list="colors" class="form-input" placeholder="#4f46e5 or indigo">
                                        <datalist id="colors">
                                            <option>indigo</option>
                                            <option>blue</option>
                                            <option>green</option>
                                            <option>amber</option>
                                        </datalist>
                                    </div>
                                    <div class="form-group md:col-span-2">
                                        <label class="form-label" for="techInput">Technologies (Press Enter to add)</label>
                                        <input id="techInput" list="techList" class="form-input" placeholder="HTML, TailwindCSS, React...">
                                        <div id="techTags" class="tag-container">
                                            <div class="tag-wrap"></div>
                                        </div>
                                        <datalist id="techList">
                                            <option>HTML</option>
                                            <option>TailwindCSS</option>
                                            <option>React</option>
                                            <option>Next.js</option>
                                            <option>Framer</option>
                                            <option>v0</option>
                                        </datalist>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="tone">Tone / Voice</label>
                                        <select id="tone" class="form-select">
                                            <option>Profesional, jelas, ringkas</option>
                                            <option>Santai dan persuasif</option>
                                            <option>Teknis dan detail</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="preset">Preset</label>
                                        <select id="preset" class="form-select">
                                            <option value="">— Select Preset —</option>
                                            <option value="saas">SaaS</option>
                                            <option value="umkm">UMKM</option>
                                            <option value="restaurant">Restaurant</option>
                                            <option value="portfolio">Portfolio</option>
                                            <option value="course">Online Course</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Panel 2: Landing Page -->
                    <div id="panel-2" class="panel">
                        <div class="panel-card">
                            <div class="panel-header">
                                <h2>🏠 Landing Page</h2>
                                <p>Configure the main sections of your landing page.</p>
                            </div>

                            <div class="tab-nav">
                                <button class="tab-btn active" data-tab="tab-hero">Hero</button>
                                <button class="tab-btn" data-tab="tab-features">Features</button>
                                <button class="tab-btn" data-tab="tab-testi">Testimonials</button>
                                <button class="tab-btn" data-tab="tab-pricing">Pricing</button>
                                <button class="tab-btn" data-tab="tab-faq">FAQ</button>
                                <button class="tab-btn" data-tab="tab-gallery">Gallery</button>
                                <button class="tab-btn" data-tab="tab-cta">CTA & Footer</button>
                            </div>

                            <div class="panel-body">
                                <!-- Hero Tab -->
                                <div id="tab-hero" class="tab-content active">
                                    <div class="panel-grid">
                                        <div class="form-group">
                                            <label class="form-label" for="heroImagePos">Image Position</label>
                                            <select id="heroImagePos" class="form-select">
                                                <option>background</option>
                                                <option>kiri</option>
                                                <option>kanan</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="heroBgType">Background Type</label>
                                            <select id="heroBgType" class="form-select">
                                                <option>solid</option>
                                                <option>gradient</option>
                                                <option>image</option>
                                                <option>video</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="heroMedia">Media URL</label>
                                            <input id="heroMedia" class="form-input" placeholder="URL gambar/video (opsional)">
                                        </div>
                                        <div class="form-group md:col-span-2">
                                            <label class="form-label" for="heroHeadline">Headline</label>
                                            <input id="heroHeadline" class="form-input" placeholder="e.g., Propolis untuk Imun Keluarga">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="heroSub">Subheadline</label>
                                            <input id="heroSub" class="form-input" placeholder="Deskripsi singkat">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="heroCtaText">CTA Text</label>
                                            <input id="heroCtaText" class="form-input" placeholder="Coba Sekarang">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label" for="heroCtaLink">CTA Link</label>
                                            <input id="heroCtaLink" class="form-input" placeholder="/daftar or https://...">
                                        </div>
                                    </div>
                                </div>

                                <!-- Features Tab -->
                                <div id="tab-features" class="tab-content">
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addFeature" class="btn btn-secondary">+ Add Feature</button>
                                        <div class="text-sm" style="color: var(--gray-500);">Add feature cards</div>
                                    </div>
                                    <div id="featuresWrap" class="panel-grid"></div>
                                </div>

                                <!-- Testimonials Tab -->
                                <div id="tab-testi" class="tab-content">
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addTesti" class="btn btn-secondary">+ Add Testimonial</button>
                                    </div>
                                    <div id="testiWrap" class="panel-grid"></div>
                                </div>

                                <!-- Pricing Tab -->
                                <div id="tab-pricing" class="tab-content">
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addPlan" class="btn btn-secondary">+ Add Plan</button>
                                    </div>
                                    <div id="pricingWrap" class="panel-grid"></div>
                                </div>

                                <!-- FAQ Tab -->
                                <div id="tab-faq" class="tab-content">
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addFaq" class="btn btn-secondary">+ Add FAQ</button>
                                    </div>
                                    <div id="faqWrap" style="display: flex; flex-direction: column; gap: 1rem;"></div>
                                </div>

                                <!-- Gallery Tab -->
                                <div id="tab-gallery" class="tab-content">
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addGallery" class="btn btn-secondary">+ Add Item</button>
                                    </div>
                                    <div id="galleryWrap" class="panel-grid"></div>
                                </div>

                                <!-- CTA & Footer Tab -->
                                <div id="tab-cta" class="tab-content">
                                    <div class="form-group">
                                        <h3 class="form-label" style="font-size: 1rem; margin-bottom: 0.75rem;">Final CTA</h3>
                                        <div class="panel-grid">
                                            <div class="form-group">
                                                <label class="form-label" for="ctaHeadline">CTA Headline</label>
                                                <input id="ctaHeadline" class="form-input">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="ctaButton">CTA Button</label>
                                                <input id="ctaButton" class="form-input">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="ctaLink">CTA Link</label>
                                                <input id="ctaLink" class="form-input">
                                            </div>
                                        </div>
                                    </div>
                                    <hr style="border: none; border-top: 1px solid var(--gray-200); margin: 1.5rem 0;">
                                    <div class="form-group">
                                        <h3 class="form-label" style="font-size: 1rem; margin-bottom: 0.75rem;">Footer</h3>
                                        <div class="panel-grid">
                                            <div class="form-group">
                                                <label class="form-label" for="footerContact">Footer Contact</label>
                                                <input id="footerContact" class="form-input" placeholder="Email / WA / Address">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="copyright">Copyright</label>
                                                <input id="copyright" class="form-input" placeholder="© 2025 Brand">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label" for="footerLinks">Footer Links</label>
                                                <input id="footerLinks" class="form-input" placeholder="Kebijakan, Syarat">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Panel 3: Pages -->
                    <div id="panel-3" class="panel">
                        <div class="panel-card">
                            <div class="panel-header">
                                <h2>📄 Pages</h2>
                                <p>Select which pages to include and configure their content.</p>
                            </div>
                            <div class="panel-body">
                                <div class="panel-grid" style="gap: 0.75rem; margin-bottom: 1.5rem;">
                                    <label class="page-toggle-label">
                                        <input type="checkbox" data-target="about">
                                        <span>About</span>
                                    </label>
                                    <label class="page-toggle-label">
                                        <input type="checkbox" data-target="contact">
                                        <span>Contact</span>
                                    </label>
                                    <label class="page-toggle-label">
                                        <input type="checkbox" data-target="blog">
                                        <span>Blog</span>
                                    </label>
                                    <label class="page-toggle-label">
                                        <input type="checkbox" data-target="services">
                                        <span>Services</span>
                                    </label>
                                    <label class="page-toggle-label">
                                        <input type="checkbox" data-target="portfolio">
                                        <span>Portfolio</span>
                                    </label>
                                    <label class="page-toggle-label">
                                        <input type="checkbox" data-target="custom">
                                        <span>Custom</span>
                                    </label>
                                </div>

                                <!-- About Page -->
                                <div id="page-about" class="page-section">
                                    <h3 class="form-label" style="font-size: 1rem;">About Page Content</h3>
                                    <div class="form-group">
                                        <label class="form-label" for="aboutTitle">Title</label>
                                        <input id="aboutTitle" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="aboutDesc">Description</label>
                                        <textarea id="aboutDesc" rows="4" class="form-textarea"></textarea>
                                    </div>
                                </div>

                                <!-- Contact Page -->
                                <div id="page-contact" class="page-section">
                                    <h3 class="form-label" style="font-size: 1rem;">Contact Page Content</h3>
                                    <div class="form-group">
                                        <label class="form-label" for="contactEmail">Email</label>
                                        <input id="contactEmail" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="contactWa">WhatsApp</label>
                                        <input id="contactWa" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="contactFieldInput">Form fields (Press Enter to add)</label>
                                        <input id="contactFieldInput" class="form-input" placeholder="Nama, Email, Pesan...">
                                        <div id="contactFields" class="tag-container">
                                            <div class="tag-wrap"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Blog Page -->
                                <div id="page-blog" class="page-section">
                                    <h3 class="form-label" style="font-size: 1rem;">Blog Page Content</h3>
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addBlog" class="btn btn-secondary">+ Add Post</button>
                                    </div>
                                    <div id="blogWrap" class="panel-grid"></div>
                                </div>

                                <!-- Services Page -->
                                <div id="page-services" class="page-section">
                                    <h3 class="form-label" style="font-size: 1rem;">Services Page Content</h3>
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addService" class="btn btn-secondary">+ Add Service</button>
                                    </div>
                                    <div id="serviceWrap" class="panel-grid"></div>
                                </div>

                                <!-- Portfolio Page -->
                                <div id="page-portfolio" class="page-section">
                                    <h3 class="form-label" style="font-size: 1rem;">Portfolio Page Content</h3>
                                    <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem;">
                                        <button id="addPortfolio" class="btn btn-secondary">+ Add Project</button>
                                    </div>
                                    <div id="portfolioWrap" class="panel-grid"></div>
                                </div>

                                <!-- Custom Page -->
                                <div id="page-custom" class="page-section">
                                    <h3 class="form-label" style="font-size: 1rem;">Custom Page Content</h3>
                                    <div class="form-group">
                                        <label class="form-label" for="customName">Name</label>
                                        <input id="customName" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="customSlug">Slug</label>
                                        <input id="customSlug" class="form-input">
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label" for="customOutline">Outline</label>
                                        <textarea id="customOutline" rows="4" class="form-textarea"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Panel 4: Output -->
                    <div id="panel-4" class="panel">
                        <div class="panel-card">
                            <div class="panel-header">
                                <h2>📝 Output (Markdown)</h2>
                                <p>Generated prompt ready to copy or download as .md file.</p>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label class="form-label" for="targetAi">Target AI</label>
                                    <select id="targetAi" class="form-select">
                                        <option>General</option>
                                        <option>Framer</option>
                                        <option>v0</option>
                                        <option>Code (HTML/Tailwind)</option>
                                    </select>
                                </div>
                                <div class="form-group code-output">
                                    <textarea id="output" rows="18" class="form-textarea code-textarea" readonly></textarea>
                                    <button id="copyBtn" class="btn btn-secondary copy-btn">Copy</button>
                                </div>
                                <div class="char-counter">
                                    <div id="charCount">0 characters</div>
                                    <button id="regenBtn" class="btn btn-secondary">Regenerate</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <aside class="sidebar-panels">
                    <div class="aside-card">
                        <h3>Quick Settings</h3>
                        <div class="form-group">
                            <label class="form-label" for="lang">Language</label>
                            <select id="lang" class="form-select">
                                <option value="id">Bahasa Indonesia</option>
                                <option value="en">English</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="bulletStyle">Bullet Style</label>
                            <select id="bulletStyle" class="form-select">
                                <option>-</option>
                                <option>*</option>
                                <option>•</option>
                                <option>1.</option>
                            </select>
                        </div>
                        <div class="info-box">
                            Auto-save is active: all changes are saved to your browser.
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </main>

    <!-- Toast Notifications -->
    <div id="toast" class="toast"></div>

    <!-- Templates -->
    <template id="tplFeature">
        <div class="template-card">
            <button type="button" class="template-remove-btn remove">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="16" height="16">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="form-group">
                <label class="form-label">Title</label>
                <input class="form-input feat-title" placeholder="Feature Title">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <input class="form-input feat-desc" placeholder="Brief description">
            </div>
            <input type="hidden" class="feat-icon">
        </div>
    </template>

    <template id="tplTesti">
        <div class="template-card">
            <button type="button" class="template-remove-btn remove">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="16" height="16">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="form-group">
                <label class="form-label">Testimonial Text</label>
                <textarea class="form-textarea testi-text" rows="3" placeholder="&quot;Amazing product...&quot;"></textarea>
            </div>
            <div class="template-card-grid">
                <div class="form-group">
                    <label class="form-label">Name</label>
                    <input class="form-input testi-name" placeholder="John Doe">
                </div>
                <div class="form-group">
                    <label class="form-label">Role</label>
                    <input class="form-input testi-role" placeholder="CEO, Acme Inc.">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Rating (1-5)</label>
                <input class="form-input testi-rating" type="number" min="1" max="5" placeholder="5">
            </div>
        </div>
    </template>

    <template id="tplPlan">
        <div class="template-card">
            <button type="button" class="template-remove-btn remove">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="16" height="16">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="template-card-grid">
                <div class="form-group">
                    <label class="form-label">Plan Name</label>
                    <input class="form-input plan-name" placeholder="Basic">
                </div>
                <div class="form-group">
                    <label class="form-label">Price</label>
                    <input class="form-input plan-price" placeholder="Rp 0 /month">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Benefits (Press Enter to add)</label>
                <input class="form-input plan-benefit-input" placeholder="Benefit 1...">
                <div class="tag-container">
                    <div class="tag-wrap plan-benefits"></div>
                </div>
            </div>
            <label style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; cursor: pointer;">
                <input type="checkbox" class="form-input plan-popular">
                Mark as Popular
            </label>
        </div>
    </template>

    <template id="tplFaq">
        <div class="template-card">
            <button type="button" class="template-remove-btn remove">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="16" height="16">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="form-group">
                <label class="form-label">Question</label>
                <input class="form-input faq-q" placeholder="What is...?">
            </div>
            <div class="form-group">
                <label class="form-label">Answer</label>
                <textarea class="form-textarea faq-a" rows="3" placeholder="This is..."></textarea>
            </div>
        </div>
    </template>

    <template id="tplGallery">
        <div class="template-card">
            <button type="button" class="template-remove-btn remove">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" width="16" height="16">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                </svg>
            </button>
            <div class="form-group">
                <label class="form-label">Image URL</label>
                <input class="form-input gal-img" placeholder="https://...">
            </div>
            <div class="form-group">
                <label class="form-label">Title</label>
                <input class="form-input gal-title" placeholder="Project Title">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <input class="form-input gal-desc" placeholder="Brief description">
            </div>
        </div>
    </template>

    <script>
        // DOM utility functions
        const $ = (selector, context = document) => context.querySelector(selector);
        const $$ = (selector, context = document) => Array.from(context.querySelectorAll(selector));

        // State management
        let currentPanel = 'panel-1';
        let currentTab = 'tab-hero';
        const STORAGE_KEY = 'ai_prompt_v_optimized';

        // Panel titles for header updates
        const panelTitles = {
            'panel-1': 'Global Settings',
            'panel-2': 'Landing Page',
            'panel-3': 'Pages',
            'panel-4': 'Output'
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            initializeApp();
        });

        function initializeApp() {
            // Set up event listeners
            setupEventListeners();
            
            // Load saved data
            load();
            
            // Update UI
            update();
            
            // Show initial panel
            showPanel('panel-1');
            showTab('tab-hero');
        }

        function setupEventListeners() {
            // Panel navigation
            $$('.sidebar-btn').forEach(btn => {
                btn.addEventListener('click', () => showPanel(btn.dataset.panelId));
            });

            // Progress indicator navigation
            $$('.progress-step').forEach(step => {
                step.addEventListener('click', () => showPanel(step.dataset.panel));
            });

            // Tab navigation
            $$('#panel-2 .tab-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    showTab(btn.dataset.tab);
                });
            });

            // Page section toggles
            $$('.page-toggle-label input').forEach(cb => {
                cb.addEventListener('change', () => {
                    const target = cb.dataset.target;
                    const section = $(`#page-${target}`);
                    if (cb.checked) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                    save();
                    update();
                });
            });

            // Mobile menu
            $('#mobileMenuBtn').addEventListener('click', toggleMobileMenu);
            $('#overlay').addEventListener('click', closeMobileMenu);

            // Form inputs
            $$('input, select, textarea').forEach(input => {
                input.addEventListener('input', () => {
                    save();
                    update();
                });
            });

            // Tag inputs
            $('#techInput').addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    techTags.add(e.target.value);
                    e.target.value = '';
                    save();
                    update();
                }
            });

            $('#contactFieldInput').addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    contactTags.add(e.target.value);
                    e.target.value = '';
                    save();
                    update();
                }
            });

            // Template buttons
            $('#addFeature').addEventListener('click', () => addTemplate('tplFeature', $('#featuresWrap')));
            $('#addTesti').addEventListener('click', () => addTemplate('tplTesti', $('#testiWrap')));
            $('#addPlan').addEventListener('click', addPlanTemplate);
            $('#addFaq').addEventListener('click', () => addTemplate('tplFaq', $('#faqWrap')));
            $('#addGallery').addEventListener('click', () => addTemplate('tplGallery', $('#galleryWrap')));
            $('#addBlog')?.addEventListener('click', () => addTemplate('tplFeature', $('#blogWrap')));
            $('#addService')?.addEventListener('click', () => addTemplate('tplFeature', $('#serviceWrap')));
            $('#addPortfolio')?.addEventListener('click', () => addTemplate('tplFeature', $('#portfolioWrap')));

            // Action buttons
            $('#copyBtn').addEventListener('click', copyOutput);
            $('#regenBtn').addEventListener('click', () => {
                update();
                toast('🔄 Prompt regenerated');
            });
            $('#btnDownloadMd').addEventListener('click', downloadMarkdown);
            $('#btnExportJson').addEventListener('click', exportJson);
            $('#btnReset').addEventListener('click', resetApp);

            // Preset selector
            $('#preset').addEventListener('change', applyPreset);
        }

        // Panel navigation
        function showPanel(panelId) {
            if (currentPanel === panelId) return;

            // Update panels
            $$('.panel').forEach(panel => panel.classList.remove('active'));
            $(`#${panelId}`).classList.add('active');
            currentPanel = panelId;

            // Update sidebar buttons
            $$('.sidebar-btn').forEach(btn => btn.classList.remove('active'));
            $(`.sidebar-btn[data-panel-id="${panelId}"]`).classList.add('active');

            // Update progress indicator
            $$('.progress-step').forEach(step => {
                step.classList.remove('active', 'completed');
                if (step.dataset.panel === panelId) {
                    step.classList.add('active');
                } else if (getPanelIndex(step.dataset.panel) < getPanelIndex(panelId)) {
                    step.classList.add('completed');
                }
            });

            // Update header title
            $('#header-title').textContent = panelTitles[panelId] || 'Dashboard';

            // Close mobile menu on panel change
            closeMobileMenu();

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function getPanelIndex(panelId) {
            const panels = ['panel-1', 'panel-2', 'panel-3', 'panel-4'];
            return panels.indexOf(panelId);
        }

        // Tab navigation
        function showTab(tabId) {
            if (currentTab === tabId) return;

            // Update tabs
            $$('#panel-2 .tab-content').forEach(tab => tab.classList.remove('active'));
            $(`#${tabId}`).classList.add('active');
            currentTab = tabId;

            // Update tab buttons
            $$('#panel-2 .tab-btn').forEach(btn => btn.classList.remove('active'));
            $(`#panel-2 .tab-btn[data-tab="${tabId}"]`).classList.add('active');
        }

        // Mobile menu
        function toggleMobileMenu() {
            $('#sidebar').classList.toggle('open');
            $('#overlay').classList.toggle('open');
        }

        function closeMobileMenu() {
            $('#sidebar').classList.remove('open');
            $('#overlay').classList.remove('open');
        }

        // Tag management
        function TagInput(container) {
            const tags = new Set();
            const wrap = $('.tag-wrap', container);

            function render() {
                wrap.innerHTML = '';
                tags.forEach(tag => {
                    const chip = document.createElement('span');
                    chip.className = 'tag-chip';
                    chip.textContent = tag;

                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.innerHTML = '&times;';
                    removeBtn.addEventListener('click', () => {
                        tags.delete(tag);
                        render();
                        save();
                        update();
                    });

                    chip.appendChild(removeBtn);
                    wrap.appendChild(chip);
                });
            }

            return {
                add(value) {
                    if (!value.trim()) return;
                    tags.add(value.trim());
                    render();
                },
                set(values) {
                    tags.clear();
                    (values || []).forEach(value => tags.add(value));
                    render();
                },
                values() {
                    return Array.from(tags);
                }
            };
        }

        const techTags = TagInput($('#techTags'));
        const contactTags = TagInput($('#contactFields'));

        // Template management
        function addTemplate(templateId, container) {
            const template = $(`#${templateId}`);
            const clone = template.content.firstElementChild.cloneNode(true);

            // Add remove functionality
            $('.remove', clone).addEventListener('click', () => {
                clone.style.opacity = '0';
                clone.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    clone.remove();
                    save();
                    update();
                }, 200);
            });

            // Add input listeners
            $$('input, textarea, select', clone).forEach(input => {
                input.addEventListener('input', () => {
                    save();
                    update();
                });
            });

            container.appendChild(clone);
            save();
            update();
            return clone;
        }

        function addPlanTemplate() {
            const plan = addTemplate('tplPlan', $('#pricingWrap'));
            const benefitsWrap = $('.plan-benefits', plan);
            const input = $('.plan-benefit-input', plan);
            const benefitApi = TagInput(benefitsWrap);

            input.addEventListener('keydown', e => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    benefitApi.add(input.value);
                    input.value = '';
                    save();
                    update();
                }
            });

            plan._benefitApi = benefitApi;
        }

        // Presets
        const presets = {
            saas: {
                projectName: 'Acme Analytics',
                audience: 'Startup & product teams',
                style: 'Modern minimalis',
                color: 'indigo',
                tone: 'Profesional, jelas, ringkas',
                tech: ['HTML', 'TailwindCSS', 'React']
            },
            umkm: {
                projectName: 'Toko Kita',
                audience: 'Konsumen lokal',
                style: 'Playful berwarna',
                color: 'green',
                tone: 'Santai dan persuasif',
                tech: ['HTML', 'TailwindCSS']
            },
            restaurant: {
                projectName: 'Warung Enak',
                audience: 'Pencinta kuliner',
                style: 'Elegan premium',
                color: 'amber',
                tone: 'Santai dan persuasif',
                tech: ['HTML', 'TailwindCSS']
            },
            portfolio: {
                projectName: 'Portfolio Jane',
                audience: 'Recruiter',
                style: 'Modern minimalis',
                color: 'slate',
                tone: 'Human-friendly dan ramah',
                tech: ['HTML', 'TailwindCSS']
            },
            course: {
                projectName: 'Bootcamp JS',
                audience: 'Pelajar & developer',
                style: 'Corporate clean',
                color: 'blue',
                tone: 'Teknis dan detail',
                tech: ['HTML', 'TailwindCSS', 'Node.js']
            }
        };

        function applyPreset() {
            const presetKey = $('#preset').value;
            if (!presetKey) return;

            const preset = presets[presetKey];
            if (!preset) return;

            $('#projectName').value = preset.projectName || '';
            $('#audience').value = preset.audience || '';
            $('#style').value = preset.style || '';
            $('#color').value = preset.color || '';
            $('#tone').value = preset.tone || '';
            techTags.set(preset.tech || []);

            save();
            update();
            toast(`✅ ${presetKey.toUpperCase()} preset applied`);
        }

        // Data management
        function collectState() {
            const state = {
                // Global settings
                projectName: $('#projectName').value || '',
                audience: $('#audience').value || '',
                style: $('#style').value || '',
                color: $('#color').value || '',
                tech: techTags.values(),
                tone: $('#tone').value || '',
                
                // Hero section
                hero: {
                    pos: $('#heroImagePos').value || '',
                    bg: $('#heroBgType').value || '',
                    media: $('#heroMedia').value || '',
                    headline: $('#heroHeadline').value || '',
                    sub: $('#heroSub').value || '',
                    ctaText: $('#heroCtaText').value || '',
                    ctaLink: $('#heroCtaLink').value || ''
                },
                
                // Features
                features: $$('#featuresWrap > .template-card').map(card => ({
                    title: $('.feat-title', card).value || '',
                    desc: $('.feat-desc', card).value || '',
                    icon: $('.feat-icon', card)?.value || ''
                })),
                
                // Testimonials
                testis: $$('#testiWrap > .template-card').map(card => ({
                    name: $('.testi-name', card).value || '',
                    role: $('.testi-role', card).value || '',
                    text: $('.testi-text', card).value || '',
                    rating: $('.testi-rating', card).value || ''
                })),
                
                // Pricing plans
                plans: $$('#pricingWrap > .template-card').map(card => ({
                    name: $('.plan-name', card).value || '',
                    price: $('.plan-price', card).value || '',
                    benefits: card._benefitApi ? card._benefitApi.values() : [],
                    popular: $('.plan-popular', card).checked
                })),
                
                // FAQs
                faqs: $$('#faqWrap > .template-card').map(card => ({
                    q: $('.faq-q', card).value || '',
                    a: $('.faq-a', card).value || ''
                })),
                
                // Gallery
                gallery: $$('#galleryWrap > .template-card').map(card => ({
                    title: $('.gal-title', card).value || '',
                    img: $('.gal-img', card).value || '',
                    desc: $('.gal-desc', card).value || ''
                })),
                
                // CTA & Footer
                cta: {
                    headline: $('#ctaHeadline').value || '',
                    button: $('#ctaButton').value || '',
                    link: $('#ctaLink').value || ''
                },
                footer: {
                    contact: $('#footerContact').value || '',
                    copyright: $('#copyright').value || '',
                    links: $('#footerLinks').value || ''
                },
                
                // Pages
                pages: {
                    about: $('.page-toggle-label input[data-target="about"]').checked,
                    contact: $('.page-toggle-label input[data-target="contact"]').checked,
                    blog: $('.page-toggle-label input[data-target="blog"]').checked,
                    services: $('.page-toggle-label input[data-target="services"]').checked,
                    portfolio: $('.page-toggle-label input[data-target="portfolio"]').checked,
                    custom: $('.page-toggle-label input[data-target="custom"]').checked
                },
                
                // Page content
                about: {
                    title: $('#aboutTitle').value || '',
                    desc: $('#aboutDesc').value || ''
                },
                contactPage: {
                    email: $('#contactEmail').value || '',
                    wa: $('#contactWa').value || '',
                    fields: contactTags.values()
                },
                custom: {
                    name: $('#customName').value || '',
                    slug: $('#customSlug').value || '',
                    outline: $('#customOutline').value || ''
                }
            };
            
            return state;
        }

        function restoreState(data) {
            if (!data) return;
            
            // Global settings
            $('#projectName').value = data.projectName || '';
            $('#audience').value = data.audience || '';
            $('#style').value = data.style || '';
            $('#color').value = data.color || '';
            $('#tone').value = data.tone || '';
            techTags.set(data.tech || []);
            
            // Hero section
            if (data.hero) {
                $('#heroImagePos').value = data.hero.pos || '';
                $('#heroBgType').value = data.hero.bg || '';
                $('#heroMedia').value = data.hero.media || '';
                $('#heroHeadline').value = data.hero.headline || '';
                $('#heroSub').value = data.hero.sub || '';
                $('#heroCtaText').value = data.hero.ctaText || '';
                $('#heroCtaLink').value = data.hero.ctaLink || '';
            }
            
            // Features
            $('#featuresWrap').innerHTML = '';
            (data.features || []).forEach(feature => {
                const card = addTemplate('tplFeature', $('#featuresWrap'));
                $('.feat-title', card).value = feature.title || '';
                $('.feat-desc', card).value = feature.desc || '';
                if ($('.feat-icon', card)) {
                    $('.feat-icon', card).value = feature.icon || '';
                }
            });
            
            // Testimonials
            $('#testiWrap').innerHTML = '';
            (data.testis || []).forEach(testi => {
                const card = addTemplate('tplTesti', $('#testiWrap'));
                $('.testi-name', card).value = testi.name || '';
                $('.testi-role', card).value = testi.role || '';
                $('.testi-text', card).value = testi.text || '';
                $('.testi-rating', card).value = testi.rating || '';
            });
            
            // Pricing plans
            $('#pricingWrap').innerHTML = '';
            (data.plans || []).forEach(plan => {
                const card = addTemplate('tplPlan', $('#pricingWrap'));
                $('.plan-name', card).value = plan.name || '';
                $('.plan-price', card).value = plan.price || '';
                
                const benefitsWrap = $('.plan-benefits', card);
                const benefitApi = TagInput(benefitsWrap);
                benefitApi.set(plan.benefits || []);
                card._benefitApi = benefitApi;
                
                $('.plan-popular', card).checked = plan.popular || false;
            });
            
            // FAQs
            $('#faqWrap').innerHTML = '';
            (data.faqs || []).forEach(faq => {
                const card = addTemplate('tplFaq', $('#faqWrap'));
                $('.faq-q', card).value = faq.q || '';
                $('.faq-a', card).value = faq.a || '';
            });
            
            // Gallery
            $('#galleryWrap').innerHTML = '';
            (data.gallery || []).forEach(item => {
                const card = addTemplate('tplGallery', $('#galleryWrap'));
                $('.gal-title', card).value = item.title || '';
                $('.gal-img', card).value = item.img || '';
                $('.gal-desc', card).value = item.desc || '';
            });
            
            // CTA & Footer
            if (data.cta) {
                $('#ctaHeadline').value = data.cta.headline || '';
                $('#ctaButton').value = data.cta.button || '';
                $('#ctaLink').value = data.cta.link || '';
            }
            
            if (data.footer) {
                $('#footerContact').value = data.footer.contact || '';
                $('#copyright').value = data.footer.copyright || '';
                $('#footerLinks').value = data.footer.links || '';
            }
            
            // Pages
            $$('.page-toggle-label input').forEach(checkbox => {
                const target = checkbox.dataset.target;
                checkbox.checked = data.pages?.[target] || false;
                
                const section = $(`#page-${target}`);
                if (checkbox.checked) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
            
            // Page content
            if (data.about) {
                $('#aboutTitle').value = data.about.title || '';
                $('#aboutDesc').value = data.about.desc || '';
            }
            
            if (data.contactPage) {
                $('#contactEmail').value = data.contactPage.email || '';
                $('#contactWa').value = data.contactPage.wa || '';
                contactTags.set(data.contactPage.fields || []);
            }
            
            if (data.custom) {
                $('#customName').value = data.custom.name || '';
                $('#customSlug').value = data.custom.slug || '';
                $('#customOutline').value = data.custom.outline || '';
            }
        }

        function save() {
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(collectState()));
            } catch (e) {
                console.warn('Failed to save data:', e);
            }
        }

        function load() {
            try {
                const data = localStorage.getItem(STORAGE_KEY);
                if (data) {
                    restoreState(JSON.parse(data));
                }
            } catch (e) {
                console.warn('Failed to load data:', e);
            }
        }

        // Markdown generation
        function generateMarkdown() {
            const config = collectState();
            let md = `# ${config.projectName || 'Project'}\n\n`;
            
            // Global settings
            md += `**Target audience:** ${config.audience || '-'}  \n`;
            md += `**Style:** ${config.style || '-'}  \n`;
            md += `**Primary color:** ${config.color || '-'}  \n`;
            md += `**Technologies:** ${config.tech.join(', ') || '-'}  \n`;
            md += `**Tone:** ${config.tone || '-'}\n\n`;
            
            // Hero section
            md += `## Hero\n`;
            md += `- Image position: ${config.hero.pos || 'background'}\n`;
            md += `- Background: ${config.hero.bg || 'solid'}${config.hero.media ? ` (media: ${config.hero.media})` : ''}\n`;
            if (config.hero.headline) md += `- Headline: "${config.hero.headline}"\n`;
            if (config.hero.sub) md += `- Subheadline: "${config.hero.sub}"\n`;
            if (config.hero.ctaText) md += `- CTA: ${config.hero.ctaText} → ${config.hero.ctaLink || '#'}\n`;
            md += `\n`;
            
            // Features
            if (config.features && config.features.length) {
                md += `## Features\n`;
                md += formatList(config.features.map(f => `${f.title}${f.desc ? ` — ${f.desc}` : ''}`));
                md += `\n`;
            }
            
            // Testimonials
            if (config.testis && config.testis.length) {
                md += `## Testimonials\n`;
                md += formatList(config.testis.map(t => `"${t.text}" — ${t.name}${t.role ? `, ${t.role}` : ''}${t.rating ? ` (⭐ ${t.rating}/5)` : ''}`));
                md += `\n`;
            }
            
            // Pricing
            if (config.plans && config.plans.length) {
                md += `## Pricing\n`;
                md += formatList(config.plans.map(p => `${p.name}${p.price ? ` — ${p.price}` : ''}${p.popular ? ' (popular)' : ''}${p.benefits && p.benefits.length ? ` | benefits: ${p.benefits.join('; ')}` : ''}`));
                md += `\n`;
            }
            
            // FAQ
            if (config.faqs && config.faqs.length) {
                md += `## FAQ\n`;
                md += formatList(config.faqs.map(f => `${f.q} — ${f.a}`));
                md += `\n`;
            }
            
            // Gallery
            if (config.gallery && config.gallery.length) {
                md += `## Gallery\n`;
                md += formatList(config.gallery.map(g => `${g.title}${g.desc ? ` — ${g.desc}` : ''}${g.img ? ` (img: ${g.img})` : ''}`));
                md += `\n`;
            }
            
            // CTA
            md += `## CTA\n`;
            if (config.cta.headline) md += `- Headline: ${config.cta.headline}\n`;
            if (config.cta.button) md += `- Button: ${config.cta.button} → ${config.cta.link || '#'}\n`;
            md += `\n`;
            
            // Footer
            md += `## Footer\n`;
            if (config.footer.contact) md += `- Contact: ${config.footer.contact}\n`;
            if (config.footer.copyright) md += `- Copyright: ${config.footer.copyright}\n`;
            if (config.footer.links) md += `- Links: ${config.footer.links}\n`;
            md += `\n`;
            
            // Pages
            if (config.pages.about) {
                md += `## About Page\n`;
                md += `- Title: ${config.about.title || ''}\n`;
                md += `- Description: ${config.about.desc || ''}\n\n`;
            }
            
            if (config.pages.contact) {
                md += `## Contact Page\n`;
                md += `- Email: ${config.contactPage.email || ''}\n`;
                md += `- WhatsApp: ${config.contactPage.wa || ''}\n`;
                md += `- Form fields: ${config.contactPage.fields.join(', ')}\n\n`;
            }
            
            if (config.pages.blog) {
                md += `## Blog Page\n`;
                md += `- Posts: ${config.blogs || '...'}\n\n`;
            }
            
            if (config.pages.services) {
                md += `## Services Page\n`;
                md += `- Services: ${config.services || '...'}\n\n`;
            }
            
            if (config.pages.portfolio) {
                md += `## Portfolio Page\n`;
                md += `- Projects: ${config.portfolio || '...'}\n\n`;
            }
            
            if (config.pages.custom) {
                md += `## Custom Page: ${config.custom.name || ''}\n`;
                md += `- Slug: ${config.custom.slug || ''}\n`;
                md += `- Outline: ${config.custom.outline || ''}\n\n`;
            }
            
            // Notes for AI
            md += `---\n**Notes for AI:** Generate responsive HTML using TailwindCSS. Keep components modular per section. Provide accessibility attributes and responsive images. Output code only if requested (target: ${$('#targetAi').value || 'General'}).`;
            
            return md;
        }

        function formatList(items) {
            const bulletStyle = $('#bulletStyle').value || '-';
            if (!items || items.length === 0) return '';
            
            if (bulletStyle === '1.') {
                return items.map((item, index) => `${index + 1}. ${item}`).join('\n');
            }
            
            return items.map(item => `${bulletStyle} ${item}`).join('\n');
        }

        function update() {
            const markdown = generateMarkdown();
            $('#output').value = markdown;
            $('#charCount').textContent = `${markdown.length} characters`;
        }

        // Actions
        async function copyOutput() {
            try {
                await navigator.clipboard.writeText($('#output').value);
                toast('✅ Prompt copied to clipboard');
            } catch (err) {
                // Fallback for older browsers
                $('#output').select();
                document.execCommand('copy');
                toast('✅ Prompt copied (fallback)');
            }
        }

        function downloadMarkdown() {
            const filename = ($('#projectName').value || 'prompt').replace(/\s+/g, '_') + '.md';
            downloadFile(filename, $('#output').value);
            toast('⬇️ Markdown downloaded');
        }

        function exportJson() {
            const filename = ($('#projectName').value || 'config').replace(/\s+/g, '_') + '.json';
            downloadFile(filename, JSON.stringify(collectState(), null, 2));
            toast('⬇️ JSON exported');
        }

        function downloadFile(filename, content) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function resetApp() {
            if (confirm('Are you sure you want to reset all data? This cannot be undone.')) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        // Toast notifications
        function toast(message) {
            const toast = document.createElement('div');
            toast.className = 'toast-item';
            toast.textContent = message;
            
            $('#toast').appendChild(toast);
            
            // Remove toast after 3 seconds
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    toast.remove();
                }, 300);
            }, 3000);
        }

        // Expose functions to global scope for debugging
        window._aiPromptGen = {
            collect: collectState,
            generate: generateMarkdown,
            save: save,
            load: load
        };
    </script>
</body>
</html>
